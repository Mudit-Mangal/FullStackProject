webpackJsonp(["trackingNudge"],{"/CEQ":function(t,e){t.exports={container:"_1fKtX",slideUp:"_196wm",containerHide:"n32Go",slideDown:"_3_QG2",iconCtr:"_2NntA",icon:"_3vDYu",iconImg:"_3HGxr",content:"_3tCc7",contentTitle:"_1bDpd",contentDescription:"SOIk0",contentStatus:"_3dVrx",contentETA:"_27u1i",lineProgressBar:"_1W_YY"}},"/u0G":function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r={PORTAL_DWEB_ORDER:"portal_dweb_order"}},"4GCc":function(t,e,n){"use strict";n.d(e,"f",function(){return a}),n.d(e,"g",function(){return s}),n.d(e,"h",function(){return d}),n.d(e,"b",function(){return f}),n.d(e,"d",function(){return l}),n.d(e,"c",function(){return _}),n.d(e,"a",function(){return b}),n.d(e,"e",function(){return m});var r=n("AdWY"),o=n("UUC3"),u=n("/u0G");function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,u=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,u=t}finally{try{r||null==i.return||i.return()}finally{if(o)throw u}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=function(t,e){return t===e},s=function(t,e){return t>e},d=function(t){return t.length<26?t:t.substring(0,23)+"..."},f=function(t){var e=i(t.split(" "),2),n=e[0],r=e[1],o=i(n.split("-"),3),u=o[0],c=o[1],a=o[2],s=i(r.split(":"),3),d=s[0],f=s[1],l=s[2],_=new Date(Number(u),Number(c),Number(a),Number(d),Number(f),Number(l)),b=_.getHours(),m=_.getMinutes(),O=" AM";0===b?b=12:b>=12&&(b>12&&(b%=12),O=" PM");var p=b.toString(),j=m.toString();return b<10&&(p="0"+b),m<10&&(j="0"+m),p+":"+j+O},l=function(){return o.e},_=function(t){return Object(r.v)(t)?o.e:t.indexOf(o.f)<0?t:t.replace(o.f,o.d)},b=function(t){return!Object(r.v)(t)},m=function(t){return[function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){c(t,e,n[e])})}return t}({eventType:u.a.PORTAL_DWEB_ORDER},t)]}},"TWL+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("VAmG");n.d(e,"default",function(){return r.a})},VAmG:function(t,e,n){"use strict";n.d(e,"a",function(){return g});var r=n("GiK3"),o=n.n(r),u=n("CIox"),c=n("AdWY"),i=n("HW6M"),a=n.n(i),s=n("/CEQ"),d=n.n(s),f=n("gBd+"),l=n("W8k2"),_=n("4GCc");function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,o=O(e).call(this,t),v(j(j(n=!o||"object"!==b(o)&&"function"!=typeof o?j(r):o)),"defaultState",{deImage:Object(_.d)()}),v(j(j(n)),"_order",null),v(j(j(n)),"_pollTimeout",null),v(j(j(n)),"_orderKey",void 0),v(j(j(n)),"_poll",function(){n._isMounted&&!Object(c.v)(n._order)&&Object(l.a)(n._order).then(function(t){n._isMounted&&(t.title===n._order.title&&t.message===n._order.message||(n._order=t,Object(c.v)(t.title)?n.reset():n.forceUpdate()),t.expected_time!==n._order.expected_time&&(n._order=t,n.forceUpdate()),null===n._order||Object(l.c)(n._order)||setTimeout(function(){n._isMounted&&n.reset()},f.a))}).catch(function(){}).then(function(){n._isMounted&&!Object(c.v)(n._order)&&n.startPolling()})}),v(j(j(n)),"reset",function(){n._order=null,n.stopPolling(),n.props.fetchLaunchData()}),v(j(j(n)),"goToTrackOrder",function(t){u.browserHistory.push(Object(c.k)(f.f,n._orderKey))}),n.state=n.defaultState,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,o.a.PureComponent),n=e,(r=[{key:"_init",value:function(){var t=this;Object(c.v)(this.props.trackData)||Object(l.b)(this.props.trackData).then(function(e){t._isMounted&&Object(l.c)(e)&&window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t._isMounted&&(t._order=e,t._orderKey=e.order_key,t.props.show(),t.startPolling(),t._updateDEImage())})})}).catch(function(e){Object(c.f)(e),t.reset()})}},{key:"componentDidMount",value:function(){this._isMounted=!0,this._init()}},{key:"componentDidUpdate",value:function(t,e){t.trackData!==this.props.trackData&&this._init()}},{key:"startPolling",value:function(){Object(l.c)(this._order)&&(this.stopPolling(),this._pollTimeout=setTimeout(this._poll,f.d))}},{key:"stopPolling",value:function(){clearTimeout(this._pollTimeout)}},{key:"render",value:function(){var t;if(!this.props.visible||Object(c.v)(this._order)||Object(c.v)(this.props.trackData))return null;var e=this._order.show_eta,n="";e&&(n=Object(c.k)(f.e.ETA,this._order.expected_time));var r=a()((v(t={},d.a.container,!0),v(t,d.a.containerHide,this.props.willHide),t)),u=this.state.deImage;return o.a.createElement("div",{className:r,onClick:this.goToTrackOrder},e?o.a.createElement("span",{className:d.a.contentETA},n):o.a.createElement("span",{className:d.a.contentStatus},f.e.STATUS),o.a.createElement("div",{className:d.a.content},o.a.createElement("div",{className:d.a.contentTitle},this._order.title),o.a.createElement("div",{className:d.a.contentDescription},Object(c.I)(this._order.message))),o.a.createElement("div",{className:d.a.iconCtr},o.a.createElement("div",{className:d.a.icon},o.a.createElement("img",{src:u,className:d.a.iconImg}))))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.stopPolling()}},{key:"_setState",value:function(t,e){this._isMounted&&this.setState(t,e)}},{key:"_updateDEImage",value:function(){var t=this,e=this._order.image_url,n=Object(_.c)(e),r=new Image;r.onload=function(){t._setState({deImage:n})},r.src=n}}])&&m(n.prototype,r),i&&m(n,i),e}();g.defaultProps={trackData:{}}},W8k2:function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return a});var r=n("AdWY"),o=n("eBl1"),u=n("sg1u"),c=(n("gBd+"),function(t){return Object(o.d)({order_id:t.order_id,type:"full",is_nudge:!0}).then(function(e){return function(t,e){return Object(r.v)(t)?Promise.reject():{title:u.r(t),message:u.o(t),order_id:u.q(t),annotation:u.m(t),status_code:t.status_code,order_key:e.key,image_url:u.j(t),show_eta:u.a(t),expected_time:u.n(t)}}(e,t)})}),i=function(t){if(Object(r.v)(t)||Object(r.v)(t.orders))return Promise.reject();var e=t.orders[t.orders.length-1];return 1!==e.trackable?Promise.reject():Object(o.a)({order_id:e.order_id,type:"full"}).then(function(t){return Object(r.v)(t)||Object(r.v)(t.orders)?Promise.reject():c(t.orders[0])})},a=function(t){return 0===t.status_code}},eBl1:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"c",function(){return d}),n.d(e,"d",function(){return f}),n.d(e,"b",function(){return l}),n.d(e,"e",function(){return _});var r=n("/g+L"),o=n("AdWY"),u=n("WGcP"),c=n("1oJu");function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){a(t,e,n[e])})}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t){return Object(o.v)(t)||Object(o.v)(t.order_key)&&Object(o.v)(t.order_id)||Object(o.v)(t.type)?Promise.reject():r.a.get(Object(c.a)(u.c.ORDER_DETAILS),i({},t)).then(function(t){return t.statusCode===u.b?Promise.resolve(t.data):Promise.reject(t.statusMessage)})},d=function(t){return Object(o.v)(t)||Object(o.v)(t.order_key)&&Object(o.v)(t.order_id)||Object(o.v)(t.type)?Promise.reject():r.a.post(Object(c.a)(u.c.ORDER_TRACK),i({},t)).then(function(t){return u.f.indexOf(t.statusCode)>=0?(t.data||(t.data={}),t.data.status_code=t.statusCode,Promise.resolve(t.data)):Promise.reject(t.statusMessage.message||t.statusMessage)}).catch(function(t){return Promise.reject(t)})},f=function(t){return Object(o.v)(t)||Object(o.v)(t.order_key)&&Object(o.v)(t.order_id)||Object(o.v)(t.type)?Promise.reject():r.a.get(Object(c.a)(u.c.ORDER_TRACK_V2),i({},t)).then(function(t){return u.f.indexOf(t.statusCode)>=0?(t.data||(t.data={}),t.data.status_code=t.statusCode,Promise.resolve(t.data)):Promise.reject(t.statusMessage.message||t.statusMessage)}).catch(function(t){return Promise.reject(t)})},l=function(t){return Object(o.v)(t)||Object(o.v)(t.order_id)?Promise.reject():r.a.get(Object(c.a)(u.c.ORDER_TRACK_DE),i({},t)).then(function(t){return Number(t.statusCode)===u.b?Promise.resolve(t.data):Promise.reject(t.statusMessage.message||t.statusMessage)})},_=function(t){return r.a.post(Object(c.a)(u.c.ORDER_DELIVERED),{order_id:t.order_id}).then(function(t){return t.statusCode===u.b?Promise.resolve(t):Promise.reject(t)})}},"gBd+":function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"g",function(){return o}),n.d(e,"b",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"a",function(){return i}),n.d(e,"e",function(){return a}),n.d(e,"f",function(){return s});var r="others_pin_tracking",o="work_pin_tracking",u="home_pin_tracking",c=3e4,i=1e3,a={STATUS:"Status",ETA_MIN:"ETA: {0} mins",ETA:"ETA: {0}"},s="/order-track/{0}"},sg1u:function(t,e,n){"use strict";n.d(e,"p",function(){return u}),n.d(e,"C",function(){return c}),n.d(e,"A",function(){return i}),n.d(e,"E",function(){return a}),n.d(e,"o",function(){return s}),n.d(e,"b",function(){return d}),n.d(e,"v",function(){return f}),n.d(e,"u",function(){return l}),n.d(e,"t",function(){return _}),n.d(e,"F",function(){return b}),n.d(e,"G",function(){return m}),n.d(e,"f",function(){return O}),n.d(e,"i",function(){return p}),n.d(e,"D",function(){return j}),n.d(e,"k",function(){return v}),n.d(e,"j",function(){return g}),n.d(e,"l",function(){return y}),n.d(e,"s",function(){return h}),n.d(e,"c",function(){return E}),n.d(e,"e",function(){return P}),n.d(e,"z",function(){return k}),n.d(e,"d",function(){return w}),n.d(e,"a",function(){return q}),n.d(e,"n",function(){return D}),n.d(e,"m",function(){return T}),n.d(e,"g",function(){return A}),n.d(e,"w",function(){return C}),n.d(e,"h",function(){return R}),n.d(e,"y",function(){return S}),n.d(e,"x",function(){return M}),n.d(e,"B",function(){return N}),n.d(e,"r",function(){return x}),n.d(e,"q",function(){return I});var r=n("AdWY"),o=n("UUC3"),u=function(t){var e=Object(r.q)(t,"order_status.order_state_id",0);return Number(e)},c=function(t){return u(t)===o.m},i=function(t){return u(t)===o.l},a=function(t){var e=u(t);return[o.l,o.m].indexOf(e)>-1},s=function(t){var e=Object(r.q)(t,"order_status.messages",[]).find(function(t){return"order_status"===t.key});return e&&e.show_message&&e.value||""},d=function(t){return Object(r.q)(t,"configuration.show_map",!1)},f=function(t){return d(t)?"":Object(r.q)(t,"outlet_details.outlet_messages","")},l=function(t){return d(t)?"":Object(r.q)(t,"outlet_details.outlet_messages","")},_=function(t){return Object(r.q)(t,"outlet_details.contact_number","")},b=function(t){return!d(t)&&!!Object(r.q)(t,"message_help.ask_confirmation",0)},m=function(t){if(d(t))return!1;var e=_(t);return!(!b(t)&&0===e.length)},O=function(t){var e=Object(r.q)(t,"order_status.icon");return Object(r.m)(e,{colorEffect:"colorEffect",height:44,whiteColor:"whiteColor",width:44})},p=function(t){var e=Object(r.q)(t,"order_status.messages",[]).find(function(t){return"delay_message"===t.key});return e&&e.show_message&&e.value||""},j=function(t){var e=Object(r.q)(t,"delivery_details");return!(!e||!e.delivery_exec_contact_number)},v=function(t){return Object(r.q)(t,"delivery_details.delivery_exec_contact_number","")},g=function(t){return Object(r.q)(t,"delivery_details.delivery_exec_image_url","")},y=function(t){return Object(r.q)(t,"delivery_details.annotation.name","")},h=function(t){return Object(r.q)(t,"order_details.order_state_sequence",[])},E=function(t){return Object(r.q)(t,"configuration.is_de_trackable",!1)},P=function(t){return Object(r.q)(t,"delivery_details.batched_destinations",[]).filter(function(t){return"DONE"!==Object(r.q)(t,"status","").toUpperCase()}).map(function(t){var e,n=Object(r.q)(t,"location",{});return e=n,{lat:Number(Object(r.q)(e,"lat",null)),lng:Number(Object(r.q)(e,"lng",null))}})},k=function(t){return P(t).length>0},w=function(t){return Object(r.q)(t,"delivery_details.batched_order_message",o.o.DELIVERING_ORDER_NEARBY)},q=function(t){return Object(r.q)(t,"order_status.eta.show_eta",!1)},D=function(t){return Object(r.q)(t,"order_status.eta.eta_text","")},T=function(t){switch(Object(r.q)(t,"customer.annotation.name","").toUpperCase()){case"HOME":return"Home";case"WORK":return"Work";default:return!1}},A=function(t){var e=Object(r.q)(t,"customer.annotation.icon",null),n=Object(r.q)(t,"customer.annotation.name","").toUpperCase();if(e)return Object(r.m)(e);switch(n){case"HOME":return o.h;case"WORK":return o.k;default:return o.c}},C=function(t){var e=Object(r.q)(t,"outlet_details.annotation.icon",null);return e?Object(r.m)(e):o.c},R=function(){return o.b},S=function(t){return d(t)?"":Object(r.q)(t,"outlet_details.annotation.name","")},M=function(t){return d(t)?"":Object(r.q)(t,"outlet_details.annotation.name","")},N=function(t){var e=Object(r.q)(t,"delivery_details.location.lat"),n=Object(r.q)(t,"delivery_details.location.lng");return void 0===e||void 0===n},x=function(t){return Object(r.q)(t,"order_status.order_state","")},I=function(t){return Object(r.q)(t,"order_details.order_id","")}}});
//# sourceMappingURL=trackingNudge.a9f3e787a4cd0db.js.map